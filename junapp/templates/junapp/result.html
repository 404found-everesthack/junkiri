<head>
    <script src="http://d3js.org/d3.v4.min.js"></script>
    {% load staticfiles %}
    <script src="http://dimplejs.org/dist/dimple.v2.3.0.min.js"></script>
    <link rel="stylesheet" href="{% static 'junapp/style/css/bootstrap.min.css' %}">

    <style>
        .none {display: none}
    </style>
</head>
<body>
<h1>You will save Rs. {{ result.totalsave }} this year</h1>
<div class="row">
    <div class="col-sm-6" id="div-chart">

    </div>
    <div class="col-sm-6" id="div-chart-price">

    </div>
</div>

<script type="text/javascript">
    {% autoescape off %}
        var data={{ result.monthly }}
    {% endautoescape %}

    function filterdata() {
        var filtered_data = [];
        for (var i = 0; i < data.length; i++) {
            var dict = {
                "Month":data[i]['month'],
                "Rainfall Water Collected (lt)": data[i]['rainfall'],
                "Usage":data[i]['usage'],
                "Inital Expense":data[i]['monthlyprice'],
                "Improvised Expense":data[i]['requiredmonthlyprice'],
            };
            filtered_data.push(dict)
        }
        console.log(filtered_data);
        return filtered_data;
    }

    var svg = dimple.newSvg("#div-chart", 800, 600);
    var chart = new dimple.chart(svg, filterdata());
    var x = chart.addCategoryAxis("x", "Month");
    // First y axis is the combination axis for revenue and profit
    var y1 = chart.addMeasureAxis("y", "Rainfall Water Collected (lt)");
    var y2 = chart.addMeasureAxis("y", "Usage");
    y1.overrideMax = {{ result.max }};
    y2.overrideMax = {{ result.max }};
    var bars = chart.addSeries("Average Rainfall", dimple.plot.bar, [x,y1]);
    var lines = chart.addSeries("Water Usage", dimple.plot.line, [x,y2]);
    lines.lineMarkers = true;
    x.addOrderRule(['January','February','March','April','May','June','July','August','September','October','November','December']);

    chart.addLegend(60, 5, 680, 20, "right", lines);
    chart.addLegend(75, 20, 680, 20, "right", bars);
    chart.draw();

     var svg1 = dimple.newSvg("#div-chart-price", 800, 600);
    var chart1 = new dimple.chart(svg1, filterdata());
    var x1 = chart1.addCategoryAxis("x", "Month");
    // First y axis is the combination axis for revenue and profit
    var y3 = chart1.addMeasureAxis("y", "Inital Expense");
    var y4=chart1.addMeasureAxis("y", "Improvised Expense");
    y3.overrideMax={{ result.maxexpense }};
    y4.overrideMax={{ result.maxexpense }};
    var lines1 = chart1.addSeries("Total Expense per month", dimple.plot.line, [x1,y3]);
    var lines2 = chart1.addSeries("Reduced Expense per month", dimple.plot.line, [x1,y4]);

{#    chart1.borderColor="red";#}
    lines1.lineMarkers = true;
    x1.addOrderRule(['January','February','March','April','May','June','July','August','September','October','November','December']);
    chart1.addLegend(60, 5, 680, 20, "right", lines1);
    chart1.addLegend(75, 20, 680, 20, "right", lines2);
    chart1.draw();

</script>

</body>